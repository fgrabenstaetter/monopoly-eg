<!-- DOCTYPE html -->
<html>
<head>
    <title>Page de test</title>
    <meta charset="utf-8" />
</head>
<body>
    <h1>Tests - RÃ©sultats dans la console</h1>
    <a href="/">retour</a>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.3.0/socket.io.js"></script>

    <script type="text/javascript">
        const port = 3000;
        console.log('Test sur port ' + port);
        setTimeout(testAjax, 1e3);
        console.log(' ----------------------- ');
        setTimeout(testSocket, 2e3);

        function testAjax () {
            const route = '/';
            console.log(' [TEST AJAX] route = ' + route);

            const xhr = new XMLHttpRequest();
            xhr.open('GET', 'http://localhost:' + port + route);
            xhr.timeout = 4e3;
            xhr.onreadystatechange = () => {
                if (xhr.readyState === XMLHttpRequest.DONE)
                    console.log('status = ' + xhr.status + ' | responseText = ' + xhr.responseText);
            }

            xhr.send();
        }

        function testSocket () {
            console.log(' [TEST SOCKET] connexion socket.io avec JWT');
            const jwt = {
                test: 123456
            }
            const socket = io.connect('http://localhost:' + port, {
                'query': 'token=' + jwt
            });
            socket.on('unauthorized', (err) => {
                console.log('ERROR: ' + err)
            });
            socket.on('connectionRes', () => {
                console.log('SUCCESS connected');
            });
        }

        function testLogin () {
            // ...
        }

        function testRegister () {
            // ...
        }
    </script>
</body>
</html>
