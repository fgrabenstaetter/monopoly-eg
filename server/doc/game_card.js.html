<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: game/card.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: game/card.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const Constants = require('../lib/constants');
class Card {
    /**
     * @param description La description de la carte
     * @param effectType Le type de la carte
     * @param effectArg1 Effet d'une carte à 1 'effet'
     * @param effectArg2 2e effet d'une carte à 2 'effets'
     */
    constructor(description, effectType, effectArg1 = null, effectArg2 = null) {
        this.description = description;
        this.effectType = effectType;
        this.effectArg1 = effectArg1;
        this.effectArg2 = effectArg2;

        this.effectCallback = {
            gainMoney: this.gainMoney,
            loseMoney: this.loseMoney,
            moveAbsolute: this.moveAbsolute,
            moveRelative: this.moveRelative,
            repair: this.repair,
            anniversary: this.anniversary,
            jailEscapeCard: this.jailEscapeCard,
            goJail: this.goJail
        }[this.effectType];
    }

    /**
     * Execute la carte piocher par un joueur
     * @param game Le jeu devant executant la carte
     * @param player Le joueur ayant piocher la carte
     * @returns l'enchère
     */
    execute(game, player) {
        this.effectCallback(game, player);
    }

    /**
     * Appelée si une carte de type 'gain de monnaie' a été piochée
     * @param game Le jeu devant executant la carte
     * @param player Le joueur ayant piocher la carte
     */
    gainMoney(game, player) {
        player.addMoney(this.effectArg1);
    }

    /**
     * Appelée si une carte de type 'perte de monnaie' a été piochée
     * @param game Le jeu devant executant la carte
     * @param player Le joueur ayant piocher la carte
     */
    loseMoney(game, player) {
        if (player.money &lt; this.effectArg1) {
            game.playerNotEnoughMoney(player, this.effectArg1,
                player.nickname + ' est en faillite (ne peux pas payer la carte de ' + this.effectArg1 + '€)',
                player.nickname + ' doit hypothéquer des propriétés pour pouvoir payer la carte');
        } else
            player.loseMoney(this.effectArg1);
    }

    /**
     * Appelée si une carte de type 'gagner une carte sortie de prison' a été piochée
     * @param game Le jeu devant executant la carte
     * @param player Le joueur ayant piocher la carte
     */
    jailEscapeCard(game, player) {
        player.nbJailEscapeCards++;
    }

    //Chaque joueur doit la somme "effectArg1" au joueur courant => Case Communautaire
    /**
     * Appelée si une carte de type 'anniversaire' a été piochée
     * @param game Le jeu devant executant la carte
     * @param player Le joueur ayant piocher la carte
     */
    anniversary(game, player) {
        let sum = 0;
        for (const p of game.players) {
            if (p !== player &amp;&amp; !p.failure) {
                p.loseMoney(this.effectArg1);
                sum += this.effectArg1;
            }
        }
        player.addMoney(sum);
    }

    /**
     * Appelée si une carte de type 'mouvement absolu' a été piochée
     * @param game Le jeu devant executant la carte
     * @param player Le joueur ayant piocher la carte
     */
    moveAbsolute(game, player) {
        player.moveAbsolute(this.effectArg1);
    }

    /**
     * Appelée si une carte de type 'mouvement relatif' a été piochée
     * @param game Le jeu devant executant la carte
     * @param player Le joueur ayant piocher la carte
     */
    moveRelative(game, player) {
        player.moveRelative(this.effectArg1);
    }

    /**
     * Appelée si une carte de type 'réparation' a été piochée
     * @param game Le jeu devant executant la carte
     * @param player Le joueur ayant piocher la carte
     */
    repair(game, player) {
        let price = 0;
        for (const prop of player.properties) {
            if (prop.type === Constants.PROPERTY_TYPE.STREET) {
                if (prop.hostel)
                    price += this.effectArg2;
                else
                    price += this.effectArg1 * prop.housesNb;
            }
        }

        if (player.money &lt; price) {
            game.playerNotEnoughMoney(player, price,
                player.nickname + ' est en faillite (ne peux pas payer les réparations de ' + price + '€)',
                player.nickname + ' doit hypothéquer des propriétés pour pouvoir les réparations');
        } else
            player.loseMoney(price);
    }

    /**
     * Appelée si une carte de type 'aller en prison' a été piochée
     * @param game Le jeu devant executant la carte
     * @param player Le joueur ayant piocher la carte
     */
    goJail(game, player) {
        player.goPrison();
        game.turnData.canRollDiceAgain = false;
        game.setTurnActionData(null, null,
            game.curPlayer.nickname + ' est envoyé en session au parlement européen ! (tour 1/3)');
    }
}

module.exports = Card;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Bank.html">Bank</a></li><li><a href="Bid.html">Bid</a></li><li><a href="Card.html">Card</a></li><li><a href="Cell.html">Cell</a></li><li><a href="Chat.html">Chat</a></li><li><a href="Deck.html">Deck</a></li><li><a href="Game.html">Game</a></li><li><a href="Lobby.html">Lobby</a></li><li><a href="Matchmaking.html">Matchmaking</a></li><li><a href="Network.html">Network</a></li><li><a href="Offer.html">Offer</a></li><li><a href="Player.html">Player</a></li><li><a href="Property.html">Property</a></li><li><a href="PublicCompany.html">PublicCompany</a></li><li><a href="Street.html">Street</a></li><li><a href="Tax.html">Tax</a></li><li><a href="TrainStation.html">TrainStation</a></li><li><a href="User.html">User</a></li><li><a href="UserManager.html">UserManager</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.4</a> on Sun May 03 2020 11:35:16 GMT+0200 (GMT+02:00)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
